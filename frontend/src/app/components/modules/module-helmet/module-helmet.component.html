<div class="module-container">
  <div class="module-header">
    <div class="header-left">
      <span class="module-icon">‚õëÔ∏è</span>
      <div>
        <h1 class="module-title">Helmet / PPE Detection</h1>
        <p class="module-subtitle">Safety compliance monitoring</p>
      </div>
    </div>
    <div class="status-badge" [class.active]="isDetecting">
      <span class="badge-dot"></span>
      {{ isDetecting ? 'Detecting' : 'Standby' }}
    </div>
  </div>

  <!-- Control Buttons -->
  <div class="control-section">
    <button 
      class="control-btn primary" 
      (click)="startCamera()"
      [disabled]="cameraActive"
    >
      <span>üìπ</span> Start Camera
    </button>
    <button 
      class="control-btn danger" 
      (click)="stopCamera()"
      [disabled]="!cameraActive"
    >
      <span>‚èπÔ∏è</span> Stop Camera
    </button>
    <button 
      class="control-btn success" 
      (click)="startDetection()"
      [disabled]="isDetecting || !cameraActive"
    >
      <span>üéØ</span> Start Detecting
    </button>
    <button 
      class="control-btn warning" 
      (click)="stopDetection()"
      [disabled]="!isDetecting"
    >
      <span>‚è∏Ô∏è</span> Stop Detecting
    </button>
  </div>

  <div class="content-grid">
    <div class="video-section">
      <div class="video-container">
        <video #videoElement autoplay playsinline class="video-feed"></video>
        <div class="live-indicator" *ngIf="cameraActive">
          <span class="live-dot"></span>
          LIVE
        </div>
      </div>
    </div>

    <div class="stats-panel">
      <div class="stat-card primary">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-content">
          <p class="stat-label">Compliance Rate</p>
          <p class="stat-value">{{ detectionResult?.ppe_compliance_rate || 0 }}%</p>
        </div>
      </div>

      <div class="stat-card secondary">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-content">
          <p class="stat-label">Violations</p>
          <p class="stat-value">{{ detectionResult?.helmet_violations || 0 }}</p>
        </div>
      </div>

      <div class="stat-card tertiary">
        <div class="stat-icon">‚úîÔ∏è</div>
        <div class="stat-content">
          <p class="stat-label">Compliant Workers</p>
          <p class="stat-value">{{ detectionResult?.helmet_compliant || 0 }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="history-section">
    <h2 class="history-title">Recent Activity</h2>
    <div class="history-list">
      <div *ngFor="let entry of recentHistory" class="history-item">
        <div class="history-time">{{ formatTime(entry.timestamp) }}</div>
        <div class="history-label">{{ entry.label }}</div>
        <div class="history-value">{{ entry.value }}%</div>
      </div>

      <div *ngIf="recentHistory.length === 0" class="history-empty">
        <p>No activity recorded yet</p>
      </div>
    </div>
  </div>
</div>
